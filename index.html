<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0c2b2e">
<title>Ù…ØªØªØ¨Ø¹ Ø¹Ø¨Ø§Ø¯Ø§Øª Ø±Ù…Ø¶Ø§Ù†</title>

<style>
body {
    margin: 0;
    font-family: 'Segoe UI', Tahoma, sans-serif;
    background: linear-gradient(180deg, #062d2f, #0f4c5c);
    color: white;
    text-align: center;
}

.container {
    max-width: 420px;
    margin: auto;
    padding: 20px;
}

h2 {
    margin-top: 10px;
    font-weight: 600;
}

.lang-btn {
    margin-bottom: 10px;
}

.card {
    background: rgba(255,255,255,0.08);
    padding: 18px;
    border-radius: 18px;
    margin-top: 15px;
    backdrop-filter: blur(8px);
    box-shadow: 0 10px 25px rgba(0,0,0,0.2);
}

.checkbox {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: rgba(255,255,255,0.08);
    padding: 12px;
    margin: 10px 0;
    border-radius: 12px;
}

input[type="checkbox"] {
    transform: scale(1.3);
}

button {
    background: linear-gradient(45deg,#f9c74f,#ffd166);
    border: none;
    padding: 12px 28px;
    border-radius: 12px;
    font-size: 16px;
    cursor: pointer;
    margin-top: 10px;
}

.points {
    font-size: 24px;
    margin-top: 10px;
    color: #ffd166;
}

.badge {
    font-size: 55px;
    animation: pop 0.6s ease;
}

@keyframes pop {
    0% {transform: scale(0);}
    80% {transform: scale(1.3);}
    100% {transform: scale(1);}
}

.history {
    text-align: right;
    max-height: 200px;
    overflow-y: auto;
}

.history div {
    background: rgba(255,255,255,0.07);
    padding: 8px;
    border-radius: 8px;
    margin: 5px 0;
}
</style>
</head>

<body>

<div class="container">
    <h2 id="title">ğŸŒ™ Ù…ØªØªØ¨Ø¹ Ø¹Ø¨Ø§Ø¯Ø§Øª Ø±Ù…Ø¶Ø§Ù†</h2>
    <button class="lang-btn" onclick="toggleLang()">ğŸŒ</button>
    <div id="date"></div>

    <div class="card">
        <div class="checkbox">
            <label id="label-fast" for="fast">ØµÙŠØ§Ù…</label>
            <input type="checkbox" id="fast">
        </div>

        <div class="checkbox">
            <label id="label-quran" for="quran">Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù‚Ø±Ø¢Ù†</label>
            <input type="checkbox" id="quran">
        </div>

        <div class="checkbox">
            <label id="label-qiyam" for="qiyam">Ù‚ÙŠØ§Ù… Ø§Ù„Ù„ÙŠÙ„</label>
            <input type="checkbox" id="qiyam">
        </div>

        <div class="checkbox">
            <label id="label-dhikr" for="dhikr">Ø§Ù„Ø°ÙƒØ±</label>
            <input type="checkbox" id="dhikr">
        </div>

        <button onclick="saveDay()" id="save-btn">Ø­ÙØ¸ Ø§Ù„ÙŠÙˆÙ…</button>

        <div class="points">
            <span id="points-label">Ø§Ù„Ù†Ù‚Ø§Ø·</span>:
            <span id="points">0</span>
        </div>

        <div class="badge" id="badge"></div>
    </div>

    <div class="card">
        <h3 id="history-title">Ø§Ù„Ø³Ø¬Ù„</h3>
        <div id="history"></div>
    </div>
</div>

<script>

// Language System
let lang = localStorage.getItem("lang") || "ar";

const translations = {
  ar: {
    title: "Ù…ØªØªØ¨Ø¹ Ø¹Ø¨Ø§Ø¯Ø§Øª Ø±Ù…Ø¶Ø§Ù†",
    fast: "ØµÙŠØ§Ù…",
    quran: "Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù‚Ø±Ø¢Ù†",
    qiyam: "Ù‚ÙŠØ§Ù… Ø§Ù„Ù„ÙŠÙ„",
    dhikr: "Ø§Ù„Ø°ÙƒØ±",
    save: "Ø­ÙØ¸ Ø§Ù„ÙŠÙˆÙ…",
    history: "Ø§Ù„Ø³Ø¬Ù„",
    points: "Ø§Ù„Ù†Ù‚Ø§Ø·"
  },
  tr: {
    title: "Ramazan Ä°badet Takibi",
    fast: "OruÃ§",
    quran: "Kur'an Okuma",
    qiyam: "Gece NamazÄ±",
    dhikr: "Zikir",
    save: "GÃ¼nÃ¼ Kaydet",
    history: "GeÃ§miÅŸ",
    points: "Puan"
  }
};

function toggleLang(){
  lang = lang === "ar" ? "tr" : "ar";
  localStorage.setItem("lang", lang);
  applyLanguage();
  display(); // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ø¬Ù„ ÙˆØ§Ù„Ù†Ù‚Ø§Ø· Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
}

function applyLanguage(){
  const t = translations[lang];
  document.getElementById("title").innerText = "ğŸŒ™ " + t.title;
  document.getElementById("label-fast").innerText = t.fast;
  document.getElementById("label-quran").innerText = t.quran;
  document.getElementById("label-qiyam").innerText = t.qiyam;
  document.getElementById("label-dhikr").innerText = t.dhikr;
  document.getElementById("save-btn").innerText = t.save;
  document.getElementById("history-title").innerText = t.history;
  document.getElementById("points-label").innerText = t.points;
}

applyLanguage();

// Date
const today = new Date().toISOString().split('T')[0];
document.getElementById("date").innerText = today;

// Service Worker
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('service-worker.js');
}

// Data
function loadData() {
  return JSON.parse(localStorage.getItem("ramadanData")) || {};
}

function saveData(data) {
  localStorage.setItem("ramadanData", JSON.stringify(data));
}

function calculatePoints(day) {
  let points = 0;
  if (day.fast) points += 10;
  if (day.quran) points += 5;
  if (day.qiyam) points += 7;
  if (day.dhikr) points += 3;
  return points;
}

function updateLivePoints() {
  const day = {
    fast: fast.checked,
    quran: quran.checked,
    qiyam: qiyam.checked,
    dhikr: dhikr.checked
  };

  const livePoints = calculatePoints(day);
  document.getElementById("points").innerText = livePoints;
}


function saveDay() {
  const data = loadData();

  const day = {
    fast: fast.checked,
    quran: quran.checked,
    qiyam: qiyam.checked,
    dhikr: dhikr.checked
  };

  day.points = calculatePoints(day);
  day.complete = day.fast && day.quran && day.qiyam && day.dhikr;

  if(day.complete && navigator.vibrate){
      navigator.vibrate(200);
  }

  data[today] = day;
  saveData(data);
  display();
}

function display() {
  const data = loadData();
  let total = 0;
  const historyDiv = document.getElementById("history");
  historyDiv.innerHTML = "";

  Object.keys(data).sort().reverse().forEach(date => {
    const d = data[date];
    total += d.points;

    const item = document.createElement("div");
    item.innerHTML = `${date} â€” ${d.points} ${translations[lang].points} ${d.complete ? "â­" : ""}`;
    historyDiv.appendChild(item);
  });

  document.getElementById("points").innerText = total;
  document.getElementById("badge").innerText =
    data[today]?.complete ? "â­" : "";
}

display();

</script>

</body>
</html>